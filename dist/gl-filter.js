!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.EasyLogicGLFilter=r():t.EasyLogicGLFilter=r()}(self,(function(){return(()=>{"use strict";var t={d:(r,e)=>{for(var n in e)t.o(e,n)&&!t.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:e[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};function e(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgba(0, 0, 0, 0)";return Array.isArray(t)&&(t={r:t[0],g:t[1],b:t[2],a:t[3]}),"hex"==r?n(t):"rgb"==r?o(t,e):"hsl"==r?i(t):t}function n(t){Array.isArray(t)&&(t={r:t[0],g:t[1],b:t[2],a:t[3]});var r=t.r.toString(16);t.r<16&&(r="0"+r);var e=t.g.toString(16);t.g<16&&(e="0"+e);var n=t.b.toString(16);t.b<16&&(n="0"+n);var o="";if(t.a<1){var i=Math.floor(255*t.a);o=i.toString(16),i<16&&(o="0"+o)}return"#".concat(r).concat(e).concat(n).concat(o)}function o(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgba(0, 0, 0, 0)";if(Array.isArray(t)&&(t={r:t[0],g:t[1],b:t[2],a:t[3]}),void 0!==t)return 1==t.a||void 0===t.a?isNaN(t.r)?r:"rgb(".concat(t.r,",").concat(t.g,",").concat(t.b,")"):"rgba(".concat(t.r,",").concat(t.g,",").concat(t.b,",").concat(t.a,")")}function i(t){return Array.isArray(t)&&(t={r:t[0],g:t[1],b:t[2],a:t[3]}),1==t.a||void 0===t.a?"hsl(".concat(t.h,",").concat(t.s,"%,").concat(t.l,"%)"):"hsla(".concat(t.h,",").concat(t.s,"%,").concat(t.l,"%,").concat(t.a,")")}t.r(r),t.d(r,{default:()=>Br});const a={format:e,rgb:o,hsl:i,hex:n};function c(t,r){return r=void 0===r?1:r,Math.round(t*r)/r}function l(t){return t*Math.PI/180}function u(t){var r=180*t/Math.PI;return r<0&&(r=360+r),r}const f={round:c,radianToDegree:u,degreeToRadian:l,getXInCircle:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e+r*Math.cos(l(t))},getYInCircle:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e+r*Math.sin(l(t))},caculateAngle:function(t,r){return u(Math.atan2(r,t))}};var h={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",aqua:"rgb(0, 255, 255)",aquamarine:"rgb(127, 255, 212)",azure:"rgb(240, 255, 255)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",burlywood:"rgb(222, 184, 135)",cadetblue:"rgb(95, 158, 160)",chartreuse:"rgb(127, 255, 0)",chocolate:"rgb(210, 105, 30)",coral:"rgb(255, 127, 80)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",crimson:"rgb(237, 20, 61)",cyan:"rgb(0, 255, 255)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgray:"rgb(169, 169, 169)",darkgrey:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkorange:"rgb(255, 140, 0)",darkorchid:"rgb(153, 50, 204)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",deeppink:"rgb(255, 20, 147)",deepskyblue:"rgb(0, 191, 255)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",firebrick:"rgb(178, 34, 34)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",fuchsia:"rgb(255, 0, 255)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",goldenrod:"rgb(218, 165, 32)",gray:"rgb(128, 128, 128)",grey:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",greenyellow:"rgb(173, 255, 47)",honeydew:"rgb(240, 255, 240)",hotpink:"rgb(255, 105, 180)",indianred:"rgb(205, 92, 92)",indigo:"rgb(75, 0, 130)",ivory:"rgb(255, 255, 240)",khaki:"rgb(240, 230, 140)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lightblue:"rgb(173, 216, 230)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightgoldenrodyellow:"rgb(250, 250, 210)",lightgreen:"rgb(144, 238, 144)",lightgray:"rgb(211, 211, 211)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightsalmon:"rgb(255, 160, 122)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightyellow:"rgb(255, 255, 224)",lime:"rgb(0, 255, 0)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",maroon:"rgb(128, 0, 0)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumpurple:"rgb(147, 112, 219)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navy:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olive:"rgb(128, 128, 0)",olivedrab:"rgb(107, 142, 35)",orange:"rgb(255, 165, 0)",orangered:"rgb(255, 69, 0)",orchid:"rgb(218, 112, 214)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",paleturquoise:"rgb(175, 238, 238)",palevioletred:"rgb(219, 112, 147)",papayawhip:"rgb(255, 239, 213)",peachpuff:"rgb(255, 218, 185)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",plum:"rgb(221, 160, 221)",powderblue:"rgb(176, 224, 230)",purple:"rgb(128, 0, 128)",rebeccapurple:"rgb(102, 51, 153)",red:"rgb(255, 0, 0)",rosybrown:"rgb(188, 143, 143)",royalblue:"rgb(65, 105, 225)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",sienna:"rgb(160, 82, 45)",silver:"rgb(192, 192, 192)",skyblue:"rgb(135, 206, 235)",slateblue:"rgb(106, 90, 205)",slategray:"rgb(112, 128, 144)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",springgreen:"rgb(0, 255, 127)",steelblue:"rgb(70, 130, 180)",tan:"rgb(210, 180, 140)",teal:"rgb(0, 128, 128)",thistle:"rgb(216, 191, 216)",tomato:"rgb(255, 99, 71)",turquoise:"rgb(64, 224, 208)",violet:"rgb(238, 130, 238)",wheat:"rgb(245, 222, 179)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",yellowgreen:"rgb(154, 205, 50)",transparent:"rgba(0, 0, 0, 0)"};const s={isColorName:function(t){return!!h[t]},getColorByName:function(t){return h[t]}};function g(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+6*(r-t)*e:e<.5?r:e<2/3?t+(r-t)*(2/3-e)*6:t}function v(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.h,r=n.s,e=n.l}var o,i,a;if(t/=360,e/=100,0==(r/=100))o=i=a=e;else{var l=e<.5?e*(1+r):e+r-e*r,u=2*e-l;o=g(u,l,t+1/3),i=g(u,l,t),a=g(u,l,t-1/3)}return{r:c(255*o),g:c(255*i),b:c(255*a)}}const p={HUEtoRGB:g,HSLtoHSV:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.h,r=n.s,e=n.l}var o=v(t,r,e);return T(o.r,o.g,o.b)},HSLtoRGB:v};function d(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}var b=/(#(?:[\da-f]{8})|#(?:[\da-f]{3}){1,2}|rgb\((?:\s*\d{1,3},\s*){2}\d{1,3}\s*\)|rgba\((?:\s*\d{1,3},\s*){3}\d*\.?\d+\s*\)|hsl\(\s*\d{1,3}(?:,\s*\d{1,3}%){2}\s*\)|hsla\(\s*\d{1,3}(?:,\s*\d{1,3}%){2},\s*\d*\.?\d+\s*\)|([\w_\-]+))/gi;function m(t){var r=t.match(b),e=[];if(!r)return e;for(var n=0,o=r.length;n<o;n++)if(r[n].indexOf("#")>-1||r[n].indexOf("rgb")>-1||r[n].indexOf("hsl")>-1)e.push({color:r[n]});else{var i=s.getColorByName(r[n]);i&&e.push({color:r[n],nameColor:i})}var a={next:0};return e.forEach((function(r){var e=t.indexOf(r.color,a.next);r.startIndex=e,r.endIndex=e+r.color.length,a.next=r.endIndex})),e}function y(t){var r=m(t);return r.forEach((function(r,e){t=t.replace(r.color,"@"+e)})),{str:t,matches:r}}function x(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",e=y(t);return e.str.split(r).map((function(t,r){return t=C(t),e.matches[r]&&(t=t.replace("@"+r,e.matches[r].color)),t}))}function w(t,r){return r.forEach((function(r,e){t=t.replace("@"+e,r.color)})),t}function C(t){return t.replace(/^\s+|\s+$/g,"")}function k(t){if("string"==typeof t){if(s.isColorName(t)&&(t=s.getColorByName(t)),t.indexOf("rgb(")>-1){for(var r=0,e=(o=t.replace("rgb(","").replace(")","").split(",")).length;r<e;r++)o[r]=parseInt(C(o[r]),10);var n={type:"rgb",r:o[0],g:o[1],b:o[2],a:1};return Object.assign(n,_(n))}if(t.indexOf("rgba(")>-1){for(r=0,e=(o=t.replace("rgba(","").replace(")","").split(",")).length;r<e;r++)o[r]=e-1==r?parseFloat(C(o[r])):parseInt(C(o[r]),10);return n={type:"rgb",r:o[0],g:o[1],b:o[2],a:o[3]},Object.assign(n,_(n))}if(t.indexOf("hsl(")>-1){for(r=0,e=(o=t.replace("hsl(","").replace(")","").split(",")).length;r<e;r++)o[r]=parseFloat(C(o[r]));return n={type:"hsl",h:o[0],s:o[1],l:o[2],a:1},Object.assign(n,v(n))}if(t.indexOf("hsla(")>-1){for(r=0,e=(o=t.replace("hsla(","").replace(")","").split(",")).length;r<e;r++)o[r]=e-1==r?parseFloat(C(o[r])):parseInt(C(o[r]),10);return n={type:"hsl",h:o[0],s:o[1],l:o[2],a:o[3]},Object.assign(n,v(n))}if(0==t.indexOf("#")){var o=[],i=1;if(3==(t=t.replace("#","")).length)for(r=0,e=t.length;r<e;r++){var a=t.substr(r,1);o.push(parseInt(a+a,16))}else if(8===t.length){for(r=0,e=t.length;r<e;r+=2)o.push(parseInt(t.substr(r,2),16));i=o.pop()/255}else for(r=0,e=t.length;r<e;r+=2)o.push(parseInt(t.substr(r,2),16));return n={type:"hex",r:o[0],g:o[1],b:o[2],a:i},Object.assign(n,_(n))}}else if("number"==typeof t){if(0<=t&&t<=16777215)return n={type:"hex",r:(16711680&t)>>16,g:(65280&t)>>8,b:(255&t)>>0,a:1},Object.assign(n,_(n));if(0<=t&&t<=4294967295)return n={type:"hex",r:(4278190080&t)>>24,g:(16711680&t)>>16,b:(65280&t)>>8,a:(255&t)/255},Object.assign(n,_(n))}return t}function A(t){"string"==typeof t&&(t=x(t));var r=(t=t.map((function(t){if("string"==typeof t){var r=y(t),e=C(r.str).split(" ");return e[1]?e[1].includes("%")?e[1]=parseFloat(e[1].replace(/%/,""))/100:e[1]=parseFloat(e[1]):e[1]="*",e[0]=w(e[0],r.matches),e}if(Array.isArray(t))return t[1]?"string"==typeof t[1]&&(t[1].includes("%")?t[1]=parseFloat(t[1].replace(/%/,""))/100:t[1]=+t[1]):t[1]="*",function(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return d(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?d(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t)}))).filter((function(t){return"*"===t[1]})).length;if(r>0){var e=(1-t.filter((function(t){return"*"!=t[1]&&1!=t[1]})).map((function(t){return t[1]})).reduce((function(t,r){return t+r}),0))/r;t.forEach((function(r,n){"*"==r[1]&&n>0&&(t.length-1==n||(r[1]=e))}))}return t}const O={matches:m,convertMatches:y,convertMatchesArray:x,reverseMatches:w,parse:k,parseGradient:A,trim:C,color_regexp:b,color_split:","};function T(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}var o=t/255,i=r/255,a=e/255,c=Math.max(o,i,a),l=Math.min(o,i,a),u=c-l,f=0;return 0==u?f=0:c==o?f=(i-a)/u%6*60:c==i?f=60*((a-o)/u+2):c==a&&(f=60*((o-i)/u+4)),f<0&&(f=360+f),{h:f,s:0==c?0:u/c,v:c}}function _(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}t/=255,r/=255,e/=255;var o,i,a=Math.max(t,r,e),l=Math.min(t,r,e),u=(a+l)/2;if(a==l)o=i=0;else{var f=a-l;switch(i=u>.5?f/(2-a-l):f/(a+l),a){case t:o=(r-e)/f+(r<e?6:0);break;case r:o=(e-t)/f+2;break;case e:o=(t-r)/f+4}o/=6}return{h:c(360*o),s:c(100*i),l:c(100*u)}}function E(t){return{r:t,g:t,b:t}}function M(t,r,e){return Math.ceil(.2126*t+.7152*r+.0722*e)}function S(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}var o=M(t,r,e),i=.564*(e-o),a=.713*(t-o);return{y:o,cr:a,cb:i}}function $(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.04045;return 100*(t>r?Math.pow((t+.055)/1.055,2.4):t/12.92)}function j(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}var o=t/255,i=r/255,a=e/255,c=.4124*(o=$(o))+.3576*(i=$(i))+.1805*(a=$(a)),l=.2126*o+.7152*i+.0722*a,u=.0193*o+.1192*i+.9505*a;return{x:c,y:l,z:u}}const I={RGBtoCMYK:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}var o=t/255,i=r/255,a=e/255,c=1-Math.max(o,i,a),l=(1-o-c)/(1-c),u=(1-i-c)/(1-c),f=(1-a-c)/(1-c);return{c:l,m:u,y:f,k:c}},RGBtoGray:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}return E(S(t,r,e).y)},RGBtoHSL:_,RGBtoHSV:T,RGBtoLAB:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}return XYZtoLAB(j(t,r,e))},RGBtoSimpleGray:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}return E(Math.ceil((t+r+e)/3))},RGBtoXYZ:j,RGBtoYCrCb:S,c:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.r,r=n.g,e=n.b}return E((t+r+e)/3>90?0:255)},brightness:M,gray:E};function R(t){return Math.pow(t,3)>.008856?Math.pow(t,3):(t-16/116)/7.787}function P(t){return t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t}function B(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.x,r=n.y,e=n.z}var o=t/100,i=r/100,a=e/100,l=3.2406*o+-1.5372*i+-.4986*a,u=-.9689*o+1.8758*i+.0415*a,f=.0557*o+-.204*i+1.057*a;l=P(l),u=P(u),f=P(f);var h=c(255*l),s=c(255*u),g=c(255*f);return{r:h,g:s,b:g}}function F(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.l,r=n.a,e=n.b}var o=(t+16)/116,i=r/500+o,a=o-e/200;o=R(o);var c=95.047*(i=R(i)),l=100*o,u=108.883*(a=R(a));return{x:c,y:l,z:u}}const D={XYZtoRGB:B,LABtoRGB:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.l,r=n.a,e=n.b}return B(F(t,r,e))},LABtoXYZ:F};function U(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.h,r=n.s,e=n.v}var o=t,i=r,a=e;o>=360&&(o=0);var l=i*a,u=l*(1-Math.abs(o/60%2-1)),f=a-l,h=[];return 0<=o&&o<60?h=[l,u,0]:60<=o&&o<120?h=[u,l,0]:120<=o&&o<180?h=[0,l,u]:180<=o&&o<240?h=[0,u,l]:240<=o&&o<300?h=[u,0,l]:300<=o&&o<360&&(h=[l,0,u]),{r:c(255*(h[0]+f)),g:c(255*(h[1]+f)),b:c(255*(h[2]+f))}}const G={HSVtoHSL:function(t,r,e){if(1==arguments.length){var n=arguments[0];t=n.h,r=n.s,e=n.v}var o=U(t,r,e);return _(o.r,o.g,o.b)},HSVtoRGB:U},L={YCrCbtoRGB:function(t,r,e,n){if(1==arguments.length){var o=arguments[0];t=o.y,r=o.cr,e=o.cb,n=(n=o.bit)||0}var i=t+1.402*(r-n),a=t-.344*(e-n)-.714*(r-n),c=t+1.772*(e-n);return{r:Math.ceil(i),g:Math.ceil(a),b:Math.ceil(c)}}};function N(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"hex",i={r:c(t.r+(r.r-t.r)*n),g:c(t.g+(r.g-t.g)*n),b:c(t.b+(r.b-t.b)*n),a:c(t.a+(r.a-t.a)*n,100)};return e(i,i.a<1?"rgb":o)}function H(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(!t)return[];"string"==typeof t&&(t=x(t));for(var e=(t=t||[]).length,n=[],o=0;o<e-1;o++)for(var i=0;i<r;i++)n.push(z(t[o],t[o+1],i/r));return n}function z(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"hex",o=k(t),i=k(r);return N(o,i,e,n)}function X(t){return t=k(t),(Math.round(299*t.r)+Math.round(587*t.g)+Math.round(114*t.b))/1e3}function q(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"h",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=k(t),u=T(l),f=(a-i)*c/n,h=[],s=1;s<=n;s++)u[r]=Math.abs((c-f*s)/c),h.push(e(U(u),o));return h}H.parula=function(t){return H(["#352a87","#0f5cdd","#00b5a6","#ffc337","#fdff00"],t)},H.jet=function(t){return H(["#00008f","#0020ff","#00ffff","#51ff77","#fdff00","#ff0000","#800000"],t)},H.hsv=function(t){return H(["#ff0000","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000"],t)},H.hot=function(t){return H(["#0b0000","#ff0000","#ffff00","#ffffff"],t)},H.pink=function(t){return H(["#1e0000","#bd7b7b","#e7e5b2","#ffffff"],t)},H.bone=function(t){return H(["#000000","#4a4a68","#a6c6c6","#ffffff"],t)},H.copper=function(t){return H(["#000000","#3d2618","#9d623e","#ffa167","#ffc77f"],t)};const W={interpolateRGB:N,blend:z,mix:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"hex";return z(t,r,e,n)},scale:H,contrast:X,contrastColor:function(t){return X(t)>=128?"black":"white"},gradient:function(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,e=[],n=r-((t=A(t)).length-1),o=n,i=1,a=t.length;i<a;i++){var c=t[i-1][0],l=t[i][0],u=1==i?t[i][1]:t[i][1]-t[i-1][1],f=i==t.length-1?o:Math.floor(u*n);e=e.concat(H([c,l],f),[l]),o-=f}return e},scaleHSV:q,scaleH:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:360;return q(t,"h",r,e,n,o,1)},scaleS:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return q(t,"s",r,e,n,o,100)},scaleV:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgb",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return q(t,"v",r,e,n,o,100)}};function Y(t,r){if(t.length!==r.length)return!1;for(var e=0,n=t.length;e<n;++e)if(t[e]!==r[e])return!1;return!0}var V={euclidean:function(t,r){for(var e=0,n=0,o=t.length;n<o;n++)e+=Math.pow(r[n]-t[n],2);return Math.sqrt(e)},manhattan:function(t,r){for(var e=0,n=0,o=t.length;n<o;n++)e+=Math.abs(r[n]-t[n]);return e},max:function(t,r){for(var e=0,n=0,o=t.length;n<o;n++)e=Math.max(e,Math.abs(r[n]-t[n]));return e}},K={linear:function(t,r){var e=[],n=Math.round(Math.random()*t),o=Math.floor(t/r);do{e.push(n),n=(n+o)%t}while(e.length<r);return e},shuffle:function(t,r){for(var e=[];e.length<r;){var n=Math.round(Math.random()*t);-1==e.indexOf(n)&&e.push(n)}return e}};function Z(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",n=K[e](t.length,r);return n.map((function(r){return t[r]}))}function J(t,r,e){var n=1/0,o=0;return r.forEach((function(r,i){var a=e(t,r);a<n&&(n=a,o=i)})),o}function Q(t){if(!t.length)return[];for(var r=new Array(t[0].length),e=0,n=r.length;e<n;e++)r[e]=0;var o=0;for(n=t.length;o<n;o++)for(var i=t[o],a=o+1,c=0,l=i.length;c<l;c++)r[c]+=(i[c]-r[c])/a;return r.map((function(t){return Math.floor(t)}))}function tt(t,r,e,n){for(var o=new Array(t),i=0;i<t;i++)o[i]=[];for(var a=0,c=r.length;a<c;a++){var l=r[a];o[J(l,e,n)].push(l)}return o}function rt(t,r,e,n,o,i){for(var a=0;a<t;a++){var c=e[a],l=n[a],u=new Array(l.length);o=!Y(u=c.length>0?Q(c):r[Math.floor(i()*r.length)],l),n[a]=u}return o}const et=function(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"linear";t=t,r=r||Math.max(2,Math.ceil(Math.sqrt(t.length/2)));var i=e||"euclidean";"string"==typeof i&&(i=V[i]);for(var a=0,c=function(){return(a=(9301*a+49297)%233280)/233280},l=Z(t,r,o),u=!0,f=0;u;){var h=tt(r,t,l,i);if(u=rt(r,t,h,l,!1,c),++f%n==0)break}return l},nt={create:function(t,r){var e=document.createElement("canvas");return e.width=t||0,e.height=r||0,e},drawPixels:function(t){var r=this.create(t.width,t.height),e=r.getContext("2d"),n=e.getImageData(0,0,r.width,r.height);return n.data.set(t.pixels),e.putImageData(n,0,0),r},createHistogram:function(t,r,e,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{black:!0,red:!1,green:!1,blue:!1},i=this.create(t,r),a=i.getContext("2d");a.clearRect(0,0,t,r),a.fillStyle="white",a.fillRect(0,0,t,r),a.globalAlpha=.7;var c={black:!1};o.black?c.black=!1:c.black=!0,o.red?c.red=!1:c.red=!0,o.green?c.green=!1:c.green=!0,o.blue?c.blue=!1:c.blue=!0,Object.keys(e).forEach((function(n){if(!c[n]){var o=e[n],i=Math.max.apply(Math,o),l=t/o.length;a.fillStyle=n,o.forEach((function(t,e){var n=r*(t/i),o=e*l;a.fillRect(o,r-n,l,n)}))}})),"function"==typeof n&&n(i)},getHistogram:function(t){for(var r=new Array(256),e=new Array(256),n=new Array(256),o=new Array(256),i=0;i<256;i++)r[i]=0,e[i]=0,n[i]=0,o[i]=0;return function(t,i){!function(t,r){for(var e=0;e<t;e+=4)r(e)}(t.pixels.length,(function(i){!function(t,i){var a=Math.round($r.brightness(t[i],t[i+1],t[i+2]));r[a]++,e[t[i]]++,n[t[i+1]]++,o[t[i+2]]++}(t.pixels,i)}))}(t),{black:r,red:e,green:n,blue:o}},getBitmap:function(t,r){var e=this.drawPixels(t);return{pixels:e.getContext("2d").getImageData(r.x||0,r.y||0,r.width||e.width,r.height||e.height).data,width:r.width,height:r.height}},putBitmap:function(t,r,e){var n=this.drawPixels(t),o=this.drawPixels(r),i=n.getContext("2d");return i.drawImage(o,e.x,e.y),t.pixels=i.getImageData(0,0,t.width,t.height).data,t}};function ot(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function it(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}const at=function(){function t(r){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ot(this,t),this.isLoaded=!1,this.imageUrl=r,this.opt=e,this.initialize()}var r,e;return r=t,(e=[{key:"initialize",value:function(){this.canvas=this.createCanvas(),this.context=this.canvas.getContext("2d")}},{key:"createCanvas",value:function(){return document.createElement("canvas")}},{key:"load",value:function(t){var r=this;this.newImage=new Image;var e=this.newImage;e.onload=function(){r.isLoaded=!0,t&&t()},this.getImageUrl((function(t){e.src=t}))}},{key:"loadImage",value:function(t){var r=this,e=this.context;this.newImage=new Image;var n=this.newImage;n.onload=function(){var o=n.height/n.width;r.opt.canvasWidth&&r.opt.canvasHeight?(r.canvas.width=r.opt.canvasWidth,r.canvas.height=r.opt.canvasHeight):(r.canvas.width=r.opt.maxWidth?r.opt.maxWidth:n.width,r.canvas.height=r.canvas.width*o),e.drawImage(n,0,0,n.width,n.height,0,0,r.canvas.width,r.canvas.height),r.isLoaded=!0,t&&t()},this.getImageUrl((function(t){n.src=t}))}},{key:"getImageUrl",value:function(t){if("string"==typeof this.imageUrl)return t(this.imageUrl);if(this.imageUrl instanceof Blob){var r=new FileReader;r.onload=function(r){t(r.target.result)},r.readAsDataURL(this.imageUrl)}}},{key:"getRGBA",value:function(t,r,e,n){return[t,r,e,n]}},{key:"toArray",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),o=n.width,i=n.height,a=new Uint8ClampedArray(n.data),c={pixels:a,width:o,height:i};t||(t=function(t,r){r(t)}),t(c,(function(t){var n=nt.drawPixels(t);"canvas"==e.returnTo?r(n):r(n.toDataURL(e.outputFormat||"image/png"))}),e)}},{key:"toHistogram",value:function(t){var r=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),e=r.width,n=r.height,o={pixels:new Uint8ClampedArray(r.data),width:e,height:n};return nt.getHistogram(o)}},{key:"toRGB",value:function(){for(var t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,r=[],e=0,n=t.length;e<n;e+=4)r[r.length]=[t[e+0],t[e+1],t[e+2],t[e+3]];return r}}])&&it(r.prototype,e),t}();var ct={identity:function(){return[1,0,0,0,1,0,0,0,1]},stretching:function(t){return[t,0,0,0,1,0,0,0,1]},squeezing:function(t){return[t,0,0,0,1/t,0,0,0,1]},scale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[t=t||0===t?t:1,0,0,0,r=r||0===r?r:1,0,0,0,1]},scaleX:function(t){return this.scale(t)},scaleY:function(t){return this.scale(1,t)},translate:function(t,r){return[1,0,t,0,1,r,0,0,1]},rotate:function(t){var r=this.radian(t);return[Math.cos(r),-Math.sin(r),0,Math.sin(r),Math.cos(r),0,0,0,1]},rotate90:function(){return[0,-1,0,1,0,0,0,0,1]},rotate180:function(){return[-1,0,0,0,-1,0,0,0,1]},rotate270:function(){return[0,1,0,-1,0,0,0,0,1]},radian:function(t){return t*Math.PI/180},skew:function(t,r){var e=this.radian(t),n=this.radian(r);return[1,Math.tan(e),0,Math.tan(n),1,0,0,0,1]},skewX:function(t){var r=this.radian(t);return[1,Math.tan(r),0,0,1,0,0,0,1]},skewY:function(t){var r=this.radian(t);return[1,0,0,Math.tan(r),1,0,0,0,1]},shear1:function(t){return[1,-Math.tan(this.radian(t)/2),0,0,1,0,0,0,1]},shear2:function(t){return[1,0,0,Math.sin(this.radian(t)),1,0,0,0,1]}};const lt={CONSTANT:ct,radian:function(t){return ct.radian(t)},multiply:function(t,r){return[t[0]*r[0]+t[1]*r[1]+t[2]*r[2],t[3]*r[0]+t[4]*r[1]+t[5]*r[2],t[6]*r[0]+t[7]*r[1]+t[8]*r[2]]},identity:function(t){return this.multiply(ct.identity(),t)},translate:function(t,r,e){return this.multiply(ct.translate(t,r),e)},rotate:function(t,r){return this.multiply(ct.rotate(t),r)},shear1:function(t,r){return this.multiply(ct.shear1(t),r)},shear2:function(t,r){return this.multiply(ct.shear2(t),r)},rotateShear:function(t,r){var e=r;return e=this.shear1(t,e),e=this.shear2(t,e),this.shear1(t,e)}};var ut;function ft(t){return function(t){if(Array.isArray(t))return ht(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return ht(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ht(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ht(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function st(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var gt=0;function vt(t,r){for(var e=new Array(r),n=0;n<r;n++)e[n]=t;return e}function pt(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};forLoop(t,0,4,(function(t){r(t,t>>2)}),(function(){e()}),n.functionDumpCount,n.frameTimer,n.loopCount)}function dt(t,r,e,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};forLoop(t,0,4,(function(t){var n=t>>2;e(t,n%r,Math.floor(n/r))}),(function(){n()}),o.functionDumpCount,o.frameTimer,o.loopCount)}function bt(t,r,e){return{pixels:new Uint8ClampedArray(t),width:r,height:e}}function mt(t,r,e,n){for(var o=r.pixels.length/4,i=0,a=0,c=0,l=0,u=0,f=0,h=0;h<o;h++)c=h%r.width,a=n+(l=Math.floor(h/r.width)),(i=e+c)>t.width||a>t.height||(u=l*r.width+c<<2,f=a*t.width+i<<2,t.pixels[f]=r.pixels[u],t.pixels[f+1]=r.pixels[u+1],t.pixels[f+2]=r.pixels[u+2],t.pixels[f+3]=r.pixels[u+3])}function yt(t,r,e,n){for(var o=r.pixels.length>>2,i=0,a=0,c=0,l=0,u=0,f=0,h=0;h<o;h++)c=h%r.width,a=n+(l=Math.floor(h/r.width)),(i=e+c)>t.width||a>t.height||(u=a*t.width+i<<2,f=l*r.width+c<<2,r.pixels[f]=t.pixels[u],r.pixels[f+1]=t.pixels[u+1],r.pixels[f+2]=t.pixels[u+2],r.pixels[f+3]=t.pixels[u+3])}function xt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=t.width+r,n=t.height+r,o={pixels:new Uint8ClampedArray(e*n*4),width:e,height:n};return o}function wt(t,r){return nt.getBitmap(t,r)}function Ct(t,r,e){return nt.putBitmap(t,r,e)}st(ut={partial:Ft,multi:Pt,merge:Bt,weight:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.map((function(t){return t*r}))},repeat:vt,colorMatrix:function(t,r,e){var n=t[r],o=t[r+1],i=t[r+2],a=t[r+3];_t(t,r,e[0]*n+e[1]*o+e[2]*i+e[3]*a,e[4]*n+e[5]*o+e[6]*i+e[7]*a,e[8]*n+e[9]*o+e[10]*i+e[11]*a,e[12]*n+e[13]*o+e[14]*i+e[15]*a)},each:pt,eachXY:dt,createRandomCount:function(){return[9,16,25,36,49,64,81,100].sort((function(t,r){return.5-Math.random()}))[0]},createRandRange:function(t,r,e){for(var n=[],o=1;o<=e;o++){var i=Math.random()*(r-t)+t,a=Math.floor(10*Math.random())%2==0?-1:1;n.push(a*i)}n.sort();var c=Math.floor(e>>1),l=n[c];return n[c]=n[0],n[0]=l,n},createBitmap:bt,createBlurMatrix:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,r=Math.pow(t,2),e=1/r;return vt(e,r)},pack:function(t){return function(r,e){pt(r.pixels.length,(function(e,n){t(r.pixels,e,n,r.pixels[e],r.pixels[e+1],r.pixels[e+2],r.pixels[e+3])}),(function(){e(r)}))}},packXY:function(t){return function(r,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};dt(r.pixels.length,r.width,(function(e,n,o){t(r.pixels,e,n,o)}),(function(){e(r)}),n)}},pixel:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Tt(t,r,e),o=function(t,r){};return o.userFunction=n,o},getBitmap:wt,putBitmap:Ct,radian:function(t){return lt.CONSTANT.radian(t)},convolution:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],e=Et(t);return function(n,o){var i=Math.round(Math.sqrt(t.length)),a=xt(n,2*i);mt(a,n,i,i);for(var c=bt(a.pixels.length,a.width,a.height),l=bt(n.pixels.length,n.width,n.height),u=Mt(t,e,a.width,a.height,r),f=n.pixels.length/4,h=0;h<f;h++){var s=h,g=s%n.width+i,v=Math.floor(s/n.width)+i;u(c.pixels,a.pixels,4*(v*a.width+g),g,v)}yt(c,l,i,i),o(l)}},parseParamNumber:function(t){return"string"==typeof t&&(t=(t=t.replace(/deg/,"")).replace(/px/,"")),+t},filter:It,clamp:jt,fillColor:_t,fillPixelColor:function(t,r,e,n){_t(t,r,e[n],e[n+1],e[n+2],e[n+3])}},"multi",Pt),st(ut,"merge",Bt),st(ut,"matches",St),st(ut,"parseFilter",$t),st(ut,"partial",Ft);var kt=/(([\w_\-]+)(\(([^\)]*)\))?)+/gi;function At(t){var r=t.map((function(t){return" \n            ".concat(t.userFunction.$preContext,"\n\n            ").concat(t.userFunction.$preCallbackString,"\n\n            $r = clamp($r); $g = clamp($g); $b = clamp($b); $a = clamp($a);\n        ")})).join("\n\n"),e={clamp:jt,Color:$r};t.forEach((function(t){Object.assign(e,t.userFunction.rootContextObject)}));var n="const "+Object.keys(e).map((function(t){return" ".concat(t," = $rc.").concat(t," ")})).join(","),o=" \n    let $r = $p[$pi], $g = $p[$pi+1], $b = $p[$pi+2], $a = $p[$pi+3];\n    \n    ".concat(n,"\n\n    ").concat(r,"\n    \n    $p[$pi] = $r; $p[$pi+1] = $g; $p[$pi+2] = $b; $p[$pi+3] = $a;\n    "),i=new Function("$p","$pi","$rc",o);return function(t,r){i(t,r,e)}}function Ot(t){var r={},e=t.map((function(t){var e=[];Object.keys(t.context).forEach((function(t,r){e[t]="n$".concat(gt++).concat(t,"$")})),Object.keys(t.rootContext).forEach((function(n,o){e[n]="r$".concat(gt++).concat(n,"$"),r[e[n]]=t.rootContext[n]}));var n=Object.keys(t.context).filter((function(r){return"number"!=typeof t.context[r]&&"string"!=typeof t.context[r]&&(!Array.isArray(t.context[r])||"number"!=typeof t.context[r][0]&&"string"!=typeof t.context[r][0])})).map((function(r,n){return[e[r],JSON.stringify(t.context[r])].join(" = ")})),o=t.callback;return"function"==typeof t.callback&&((o=t.callback.toString().split("{")).shift(),(o=(o=o.join("{")).split("}")).pop(),o=o.join("}")),Object.keys(e).forEach((function(r){var n=e[r];"number"==typeof t.context[r]||"string"==typeof t.context[r]?o=o.replace(new RegExp("\\"+r,"g"),t.context[r]):!Array.isArray(t.context[r])||"number"!=typeof t.context[r][0]&&"string"!=typeof t.context[r][0]?o=o.replace(new RegExp("\\"+r,"g"),n):t.context[r].forEach((function(t,e){o=o.replace(new RegExp("\\"+r+"\\["+e+"\\]","g"),t)}))})),{preCallbackString:o,preContext:n}})),n=e.map((function(t,r){return t.preContext.length?"const ".concat(t.preContext,";"):""})).join("\n\n"),o=e.map((function(t){return t.preCallbackString})).join("\n\n"),i=" \n    let $r = $pixels[$pixelIndex], $g = $pixels[$pixelIndex+1], $b = $pixels[$pixelIndex+2], $a = $pixels[$pixelIndex+3];\n\n    ".concat(n,"\n\n    ").concat(o,"\n    \n    $pixels[$pixelIndex] = $r\n    $pixels[$pixelIndex+1] = $g \n    $pixels[$pixelIndex+2] = $b   \n    $pixels[$pixelIndex+3] = $a   \n    "),a=new Function("$pixels","$pixelIndex","$clamp","$Color",i);return a.$preCallbackString=o,a.$preContext=n,a.rootContextObject=r,a}function Tt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ot([{callback:t,context:r,rootContext:e}])}function _t(t,r,e,n,o,i){if(3==arguments.length){var a=arguments[2];e=a.r,n=a.g,o=a.b,i=a.a}"number"==typeof e&&(t[r]=e),"number"==typeof n&&(t[r+1]=n),"number"==typeof o&&(t[r+2]=o),"number"==typeof i&&(t[r+3]=i)}function Et(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,n=[];return n=t.map((function(t,r){return[]})),t.forEach((function(t,o){if(0!=t){var i=n[o];for(o=r;o<=e;o++)i[o]=t*o}})),n}function Mt(t,r,e,n,o){var i=Math.round(Math.sqrt(t.length)),a=Math.floor(i/2),c=o?1:0,l="let r = 0, g = 0, b = 0, a = 0, scy = 0, scx =0, si = 0; ",u=[],f=[],h=[],s=[];t.forEach((function(t,r){var n=Math.floor(r/i)-a,o=r%i-a;0!=t&&(u.push("$t[".concat(r,"][$sp[(($sy + (").concat(n,")) * ").concat(e," + ($sx + (").concat(o,"))) * 4]]")),f.push("$t[".concat(r,"][$sp[(($sy + (").concat(n,")) * ").concat(e," + ($sx + (").concat(o,"))) * 4 + 1]]")),h.push("$t[".concat(r,"][$sp[(($sy + (").concat(n,")) * ").concat(e," + ($sx + (").concat(o,"))) * 4 + 2]]")),s.push("$t[".concat(r,"][$sp[(($sy + (").concat(n,")) * ").concat(e," + ($sx + (").concat(o,"))) * 4 + 3]]")))})),l+="r = ".concat(u.join(" + "),"; g = ").concat(f.join(" + "),"; b = ").concat(h.join(" + "),"; a = ").concat(s.join(" + "),";"),l+="$dp[$di] = r; $dp[$di+1] = g;$dp[$di+2] = b;$dp[$di+3] = a + (".concat(c,")*(255-a); ");var g=new Function("$dp","$sp","$di","$sx","$sy","$t",l);return function(t,e,n,o,i){g(t,e,n,o,i,r)}}function St(t){var r=$r.convertMatches(t),e=r.str.match(kt),n=[];if(!e)return n;n=e.map((function(t){return{filter:t,origin:$r.reverseMatches(t,r.matches)}}));var o={next:0};return n.map((function(r){var e=t.indexOf(r.origin,o.next);return r.startIndex=e,r.endIndex=e+r.origin.length,r.arr=$t(r.origin),o.next=r.endIndex,r})).filter((function(t){return!!t.arr.length}))}function $t(t){var r=$r.convertMatches(t),e=r.str.match(kt);if(!e[0])return[];var n=e[0].split("("),o=n.shift(),i=[];return n.length&&(i=n.shift().split(")")[0].split(",").map((function(t){return $r.reverseMatches(t,r.matches)}))),[o].concat(ft(i)).map($r.trim)}function jt(t){return Math.min(255,t)}function It(t){return Bt(St(t).map((function(t){return t.arr})))}function Rt(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=[],e=[],n=0,o=t.length;n<o;n++){var i=t[n];i.userFunction?e.push(i):(e.length&&r.push(ft(e)),r.push(i),e=[])}return e.length&&r.push(ft(e)),r.forEach((function(t,e){var n;Array.isArray(t)&&(r[e]=(n=At(t),function(t,r){for(var e=0,o=t.pixels.length;e<o;e+=4)n(t.pixels,e);r(t)}))})),r}function Pt(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];var n=(r=Rt(r=r.map((function(t){return makeFilter(t)})).filter((function(t){return t})))).length;return function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=t,a=0;function c(){r[a].call(null,i,(function(t){i=t,l()}),o)}function l(){++a>=n?e(i):c()}c()}}function Bt(t){return Pt.apply(void 0,ft(t))}function Ft(t){for(var r=null,e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return r=1==n.length&&"string"==typeof n[0]?It(n[0]):Bt(n),function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(wt(e,t),(function(r){n(Ct(e,r,t))}),o)}}function Dt(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Ut(t){return"string"==typeof t&&(t=(t=t.replace(/deg/,"")).replace(/px/,"")),+t}function Gt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.map((function(t){return t*r}))}var Lt=0;function Nt(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return r}function Ht(t){return{type:"convolution",length:t.length,content:t}}function zt(t,r){return"\n        if (u_filterIndex == ".concat(r,".0) {\n            ").concat(t,"\n        }\n    ")}function Xt(t,r){return{type:"shader",index:Lt,options:r,content:zt(t,Lt++)}}function qt(t){return"\n    \n    if (u_kernelSelect == ".concat(t,".0) {\n        vec4 colorSum = ").concat(function(t){var r,e=Math.sqrt(t),n=Math.floor(e/2);return(r=Array(t),function(t){if(Array.isArray(t))return Dt(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,r){if(t){if("string"==typeof t)return Dt(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Dt(t,r):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(r,o){var i=Math.floor(o/e)-n;return"texture(u_image, v_texCoord + onePixel * vec2(".concat(o%e-n,", ").concat(i,")) * u_kernel").concat(t,"[").concat(o,"]")})).join(" + \n")}(t),"; \n\n        outColor = vec4((colorSum / u_kernel").concat(t,"Weight).rgb, 1);\n    }\n    ")}function Wt(t){return"vec4("+(t=[t.r/255,t.g/255,t.b/255,t.a||0].map(Yt))+")"}function Yt(t){return t==Math.floor(t)?t+".0":t}function Vt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Ut(t)*(1/16);return Ht(Gt([1,2,1,2,4,2,1,2,1],r))}function Kt(){return Ht([1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1])}function Zt(){return Ht([5,5,5,-3,0,-3,-3,-3,-3])}function Jt(){return Ht([5,-3,-3,5,0,-3,5,-3,-3])}function Qt(){return Ht([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}function tr(){return Ht([1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1])}function rr(){return Ht([1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1])}function er(){return Ht([1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0,0,0,1])}function nr(){return Ht([-1,-2,-1,0,0,0,1,2,1])}function or(){return Ht([-1,0,1,-2,0,2,-1,0,1])}function ir(){return Ht(Gt([1,4,6,4,1,4,16,24,16,4,6,24,-476,24,6,4,16,24,16,4,1,4,6,4,1],-1/256))}function ar(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,s=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,g=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,v=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,p=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0,d=[t,r,e,n,o,i,a,c,l,u,f,h,s,g,v,p].map(Yt);return Xt("\n\n        outColor = vec4(\n            ".concat(d[0]," * pixelColor.r + ").concat(d[1]," * pixelColor.g + ").concat(d[2]," * pixelColor.b + ").concat(d[3]," * pixelColor.a,\n            ").concat(d[4]," * pixelColor.r + ").concat(d[5]," * pixelColor.g + ").concat(d[6]," * pixelColor.b + ").concat(d[7]," * pixelColor.a,\n            ").concat(d[8]," * pixelColor.r + ").concat(d[9]," * pixelColor.g + ").concat(d[10]," * pixelColor.b + ").concat(d[11]," * pixelColor.a,\n            ").concat(d[12]," * pixelColor.r + ").concat(d[13]," * pixelColor.g + ").concat(d[14]," * pixelColor.b + ").concat(d[15]," * pixelColor.a\n        ); \n    "))}function cr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t=Yt(Ut(t)),Xt("\n        float c = ( (pixelColor.r * 0.2126 + pixelColor.g * 0.7152 + pixelColor.b * 0.0722) ) >= ".concat(t," ? 1.0 : 0.0;\n\n        outColor = vec4(c, c, c, pixelColor.a);\n    "))}const lr={bitonal:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,n=Yt(e),o=Wt($r.parse(t)),i=Wt($r.parse(r));return Xt("\n        if ((pixelColor.r + pixelColor.g + pixelColor.b) > ".concat(n,") {\n            outColor = vec4(").concat(i,".rgb, pixelColor.a);\n        } else {\n            outColor = vec4(").concat(o,".rgb, pixelColor.a);\n        }\n    "))},brightness:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        outColor = pixelColor + (".concat(r,");\n    "))},brownie:function(){return ar(.5997023498159715,.34553243048391263,-.2708298674538042,0,-.037703249837783157,.8609577587992641,.15059552388459913,0,.24113635128153335,-.07441037908422492,.44972182064877153,0,0,0,0,1)},clip:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=Yt(Ut(t));return Xt("\n        outColor = vec4(\n            (pixelColor.r > 1.0 - ".concat(r,") ? 1.0 : 0.0,\n            (pixelColor.g > 1.0 - ").concat(r,") ? 1.0 : 0.0,\n            (pixelColor.b > 1.0 - ").concat(r,") ? 1.0 : 0.0,\n            pixelColor.a \n        );\n    "))},chaos:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,r=Yt(Ut(t));return Xt("\n        vec2 st = pixelColor.st;\n        st *= ".concat(r,";\n        \n        vec2 ipos = floor(st);  // get the integer coords\n\n        vec3 color = vec3(random( ipos ));\n\n        outColor = vec4(color, pixelColor.a);\n    "))},contrast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        outColor = pixelColor * ".concat(r,";\n    "))},gamma:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        outColor = vec4(pow(pixelColor.r, ".concat(r,"), pow(pixelColor.g, ").concat(r,"), pow(pixelColor.b, ").concat(r,"), pixelColor.a );\n    "))},gradient:function(){var t=Array.prototype.slice.call(arguments);1===t.length&&"string"==typeof t[0]&&(t=$r.convertMatchesArray(t[0])),t=t.map((function(t){return t})).join(", ");var r=$r.parseGradient(t);r[0][1]=0,r[r.length-1][1]=1;for(var e=[],n=0,o=(r=r.map((function(t){var r=$r.parse(t[0]);return[{r:r.r,g:r.g,b:r.b,a:r.a},t[1]]}))).length;n<o-1;n++){var i=r[n],a=r[n+1],c=Wt(i[0]),l=Wt(a[0]),u=Yt(i[1]),f=Yt(a[1]);e.push("\n            if (".concat(u," <= rate && rate < ").concat(f,") {\n                outColor = mix(").concat(c,", ").concat(l,", (rate - ").concat(u,")/(").concat(f," - ").concat(u,"));\n            }\n        "))}return Xt("\n        float rate = (pixelColor.r * 0.2126 + pixelColor.g * 0.7152 + pixelColor.b * 0.0722); \n\n        ".concat(e.join("\n"),"        \n    "))},grayscale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Ut(t);return r>1&&(r=1),ar(.2126+.7874*(1-r),.7152-.7152*(1-r),.0722-.0722*(1-r),0,.2126-.2126*(1-r),.7152+.2848*(1-r),.0722-.0722*(1-r),0,.2126-.2126*(1-r),.7152-.7152*(1-r),.0722+.9278*(1-r),0,0,0,0,1)},hue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        vec3 hsv = rgb2hsv(pixelColor.rgb);\n        hsv.x += ".concat(r,";\n        outColor = vec4(hsv2rgb(hsv).rgb, pixelColor.a);\n    "))},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        outColor = vec4(\n            (1.0 - pixelColor.r) * ".concat(r,",\n            (1.0 - pixelColor.g) * ").concat(r,",\n            (1.0 - pixelColor.b) * ").concat(r,",\n            pixelColor.a\n        );\n    "))},kodachrome:function(){return ar(1.1285582396593525,-.3967382283601348,-.03992559172921793,0,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,0,0,0,1)},matrix:ar,noise:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Math.abs(Ut(t)),e=Yt(-r),n=Yt(r);return Xt("\n        float rnd = ".concat(e," + random( pixelColor.st ) * (").concat(n," - ").concat(e,");\n\n        outColor = vec4(pixelColor.rgb + rnd, 1.0);\n    "))},opacity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Yt(Ut(t));return Xt("\n        outColor = vec4(pixelColor.rgb, pixelColor.a * ".concat(r,");\n    "))},polaroid:function(){return ar(1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1)},saturation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=1-Math.abs(Ut(t));return ar(r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,r)},sepia:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=Ut(t);return r>1&&(r=1),ar(.393+.607*(1-r),.769-.769*(1-r),.189-.189*(1-r),0,.349-.349*(1-r),.686+.314*(1-r),.168-.168*(1-r),0,.272-.272*(1-r),.534-.534*(1-r),.131+.869*(1-r),0,0,0,0,1)},shade:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=Yt(Ut(t)/255),o=Yt(Ut(r)/255),i=Yt(Ut(e)/255);return Xt("\n        outColor = vec4(\n            pixelColor.r * ".concat(n,",\n            pixelColor.g * ").concat(o,",\n            pixelColor.b * ").concat(i,",\n            pixelColor.a\n        );\n    "))},shift:function(){return ar(1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1)},solarize:function(t,r,e){var n=Yt(Ut(t)),o=Yt(Ut(r)),i=Yt(Ut(e));return Xt("\n        outColor = vec4(\n            (pixelColor.r < ".concat(n,") ? 1.0 - pixelColor.r: pixelColor.r,\n            (pixelColor.g < ").concat(o,") ? 1.0 - pixelColor.g: pixelColor.g,\n            (pixelColor.b < ").concat(i,") ? 1.0 - pixelColor.b: pixelColor.b,\n            pixelColor.a\n        );\n    "))},technicolor:function(){return ar(1.9125277891456083,-.8545344976951645,-.09155508482755585,0,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-.231103377548616,-.7501899197440212,1.847597816108189,0,0,0,0,1)},threshold:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return cr(t,r,!1)},"threshold-color":cr,tint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Ut(t),o=Ut(r),i=Ut(e);return Xt("\n        outColor = vec4(\n            pixelColor.r += (1 - pixelColor.r) * ".concat(n,",\n            pixelColor.g += (1 - pixelColor.g) * ").concat(o,",\n            pixelColor.b += (1 - pixelColor.b) * ").concat(i,",\n            pixelColor.a\n        );\n    "))}},ur={kirsch:function(){return Nt("kirsch-horizontal kirsch-vertical")},sobel:function(){return Nt("sobel-horizontal sobel-vertical")},vintage:function(){return Nt("brightness(0.15) saturation(-0.2) gamma(1.8)")}};function fr(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function hr(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?fr(Object(e),!0).forEach((function(r){sr(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):fr(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function sr(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}const gr=hr(hr(hr({},{blur:function(){return Ht([1,1,1,1,1,1,1,1,1])},normal:function(){return Ht([0,0,0,0,1,0,0,0,0])},emboss:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return Ht([-2*(t=Ut(t)),-t,0,-t,1,t,0,t,2*t])},gaussianBlur:Vt,"gaussian-blur":Vt,gaussianBlur5x:Kt,"gaussian-blur-5x":Kt,grayscale2:function(){return Ht([.3,.3,.3,0,0,.59,.59,.59,0,0,.11,.11,.11,0,0,0,0,0,0,0,0,0,0,0,0])},kirschHorizontal:Zt,"kirsch-horizontal":Zt,kirschVertical:Jt,"kirsch-vertical":Jt,laplacian:function(){return Ht([-1,-1,-1,-1,8,-1,-1,-1,-1])},laplacian5x:Qt,"laplacian-5x":Qt,motionBlur:tr,"motion-blur":tr,motionBlur2:rr,"motion-blur-2":rr,motionBlur3:er,"motion-blur-3":er,negative:function(){return Ht([-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,1,0,1,1,1,1,1])},sepia2:function(){return Ht([.393,.349,.272,0,0,.769,.686,.534,0,0,.189,.168,.131,0,0,0,0,0,0,0,0,0,0,0,0])},sharpen:function(){return Ht([0,-1,0,-1,5,-1,0,-1,0])},sobelHorizontal:nr,"sobel-horizontal":nr,sobelVertical:or,"sobel-vertical":or,transparency:function(){return Ht([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,.3,0,0,0,0,0,1])},unsharpMasking:ir,"unsharp-masking":ir}),lr),ur);function vr(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function pr(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var dr=0;const br={GLCanvas:function(){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{width:"400px",height:"300px"};vr(this,t),this.img=r.img,this.width=parseFloat(this.img.width||r.width||"400px"),this.height=parseFloat(this.img.height||r.height||"300px"),this.init()}var r,e;return r=t,(e=[{key:"resize",value:function(){this.canvas.width=this.width,this.canvas.height=this.height,this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.viewport()}},{key:"clear",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this.gl;o.clearColor(t,r,e,n),o.clear(o.COLOR_BUFFER_BIT|o.DEPTH_BUFFER_BIT)}},{key:"viewport",value:function(t,r,e,n){var o=this.gl;o.viewport(t||0,r||0,e||o.canvas.width,n||o.canvas.height)}},{key:"initCanvas",value:function(t,r){if(this.canvas=document.createElement("canvas"),this.gl=this.canvas.getContext("webgl2"),!this.gl)throw new Error("you need webgl2 support");this.program=this.createProgram(t,r),this.resize(),this.initBuffer()}},{key:"draw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TRIANGLES",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,n=this.gl;n.drawArrays(n[t],r,e)}},{key:"triangles",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;this.draw("TRIANGLES",t,r)}},{key:"uniform2f",value:function(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var o=e.shift();(t=this.gl).uniform2f.apply(t,[this.locations[o]].concat(e))}},{key:"uniform1f",value:function(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var o=e.shift();(t=this.gl).uniform1f.apply(t,[this.locations[o]].concat(e))}},{key:"uniform1fv",value:function(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var o=e.shift();(t=this.gl).uniform1fv.apply(t,[this.locations[o]].concat(e))}},{key:"uniform1i",value:function(){for(var t,r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];var o=e.shift();(t=this.gl).uniform1i.apply(t,[this.locations[o]].concat(e))}},{key:"useProgram",value:function(){this.gl.useProgram(this.program)}},{key:"bindBuffer",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"STATIC_DRAW",n=this.gl;this.buffers[t]||(this.buffers[t]=n.createBuffer()),n.bindBuffer(n.ARRAY_BUFFER,this.buffers[t]),r&&n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n[e])}},{key:"enable",value:function(t){this.gl.enableVertexAttribArray(this.locations[t])}},{key:"location",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"attribute";"attribute"===r?this.locations[t]=this.gl.getAttribLocation(this.program,t):"uniform"===r&&(this.locations[t]=this.gl.getUniformLocation(this.program,t))}},{key:"a",value:function(t){return this.location(t)}},{key:"u",value:function(t){return this.location(t,"uniform")}},{key:"pointer",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FLOAT",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=this.gl;a.vertexAttribPointer(this.locations[t],e,a[r],n,o,i)}},{key:"bufferData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=this.gl;r.bufferData(r.ARRAY_BUFFER,new Float32Array(t),r.STATIC_DRAW)}},{key:"isPowerOf2",value:function(t){return 0==(t&t-1)}},{key:"bindTexture",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"RGBA",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"RGBA",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"UNSIGNED_BYTE",a=this.gl;1!=arguments.length?(this.textures[t]||(this.textures[t]=a.createTexture()),this.textureIndex[t]=dr++,a.bindTexture(a.TEXTURE_2D,this.textures[t]),this.setTextureParameter(),a.texImage2D(a.TEXTURE_2D,e,a[n],a[o],a[i],r.newImage||r)):a.bindTexture(a.TEXTURE_2D,this.textures[t])}},{key:"bindColorTexture",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:256,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"RGBA",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"RGBA",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"UNSIGNED_BYTE",l=this.gl;this.textures[t]||(this.textures[t]=l.createTexture()),this.textureIndex[t]=dr++,l.bindTexture(l.TEXTURE_2D,this.textures[t]),this.setTextureParameter(),l.texImage2D(l.TEXTURE_2D,o,l[i],e,n,0,l[a],l[c],new Uint8Array(r))}},{key:"bindEmptyTexture",value:function(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"RGBA",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"RGBA",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"UNSIGNED_BYTE",c=this.gl;this.textures[t]||(this.textures[t]=c.createTexture()),this.textureIndex[t]=dr++,c.bindTexture(c.TEXTURE_2D,this.textures[t]),this.setTextureParameter();var l=0,u=null;c.texImage2D(c.TEXTURE_2D,n,c[o],r,e,l,c[i],c[a],u)}},{key:"setTextureParameter",value:function(){var t=this.gl;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)}},{key:"bindFrameBufferWithTexture",value:function(t,r,e,n){this.bindEmptyTexture(r,e,n),this.bindFrameBuffer(t,r)}},{key:"enumToString",value:function(t){var r=this.gl;if(0===t)return"NONE";for(var e in r)if(r[e]===t)return e;return"0x"+t.toString(16)}},{key:"bindFrameBuffer",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=this.gl;if(1!==arguments.length){this.framebuffers[t]||(this.framebuffers[t]=e.createFramebuffer()),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffers[t]);var n=0,o=e.COLOR_ATTACHMENT0;e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,this.textures[r],n),e.checkFramebufferStatus(e.FRAMEBUFFER),e.FRAMEBUFFER_COMPLETE}else e.bindFramebuffer(e.FRAMEBUFFER,null==t?null:this.framebuffers[t])}},{key:"bindVA",value:function(){var t=this.gl;this.vao||(this.vao=t.createVertexArray()),t.bindVertexArray(this.vao)}},{key:"bindAttr",value:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"STATIC_DRAW",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;this.bindBuffer(t,r,e),this.enable(t),this.pointer(t,"FLOAT",n)}},{key:"initBuffer",value:function(){var t=this.canvas,r=t.width,e=t.height;this.a("a_position"),this.a("a_texCoord"),this.u("u_resolution"),this.u("u_image"),this.u("u_flipY"),this.u("u_kernelSelect"),this.u("u_filterIndex"),this.u("u_kernel9[0]"),this.u("u_kernel9Weight"),this.u("u_kernel25[0]"),this.u("u_kernel25Weight"),this.u("u_kernel49[0]"),this.u("u_kernel49Weight"),this.u("u_kernel81[0]"),this.u("u_kernel81Weight"),this.bindVA(),this.bindAttr("a_position",[0,0,r,0,0,e,0,e,r,0,r,e],"STATIC_DRAW",2),this.bindAttr("a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],"STATIC_DRAW",2),this.bindTexture("u_image",this.img),this.bindFrameBufferWithTexture("frame_buffer_0","img_texture_0",r,e),this.bindFrameBufferWithTexture("frame_buffer_1","img_texture_1",r,e)}},{key:"activeTexture",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=this.gl;r.activeTexture(r.TEXTURE0+t)}},{key:"drawFilter",value:function(){var t=this,r=this.gl;this.resize(),this.clear(),this.useProgram(),this.bindVA(),this.activeTexture(0),this.bindTexture("u_image"),this.uniform1i("u_image",0),this.uniform1f("u_flipY",1);var e=r.canvas,n=e.width,o=e.height;this.eachFilter((function(r,e){t.bindFrameBuffer("frame_buffer_".concat(e%2)),t.uniform2f("u_resolution",n,o),t.viewport(0,0,n,o),t.effectFilter(r),t.bindTexture("img_texture_".concat(e%2))})),this.uniform1f("u_flipY",-1),this.bindFrameBuffer(null),this.uniform2f("u_resolution",n,o),this.viewport(0,0,n,o),this.clear(),this.effectFilter("normal")}},{key:"effectFilter",value:function(t){"string"==typeof t&&(t=(gr[t]||gr.normal).call(gr)),"convolution"==t.type?(this.uniform1f("u_kernelSelect",t.length),this.uniform1f("u_filterIndex",-1),this.uniform1fv("u_kernel".concat(t.length,"[0]"),t.content),this.uniform1f("u_kernel".concat(t.length,"Weight"),this.computeKernelWeight(t.content))):(this.uniform1f("u_kernelSelect",-1),this.uniform1f("u_filterIndex",t.index)),this.triangles(0,6)}},{key:"computeKernelWeight",value:function(t){var r=t.reduce((function(t,r){return t+r}));return r<=0?1:r}},{key:"createProgram",value:function(t,r){var e=this.gl,n=e.createProgram();if(this.vertexShader=this.createVertexShader(t),this.fragmentShader=this.createFragmentShader(r),e.attachShader(n,this.vertexShader),e.attachShader(n,this.fragmentShader),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS))return n;console.error(e.getProgramInfoLog(n)),e.deleteProgram(n)}},{key:"createShader",value:function(t,r){var e=this.gl,n=e.createShader(t);if(e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.error(e.getShaderInfoLog(n)),e.deleteShader(n)}},{key:"createVertexShader",value:function(t){var r=this.gl;return this.createShader(r.VERTEX_SHADER,t)}},{key:"createFragmentShader",value:function(t){var r=this.gl;return this.createShader(r.FRAGMENT_SHADER,t)}},{key:"eachFilter",value:function(t){this.filterList.forEach(t)}},{key:"init",value:function(){this.locations={},this.buffers={},this.framebuffers={},this.textures={},this.textureIndex={},this.hasTexParameter={}}},{key:"destroy",value:function(){var t=this.gl;this.init(),t.deleteProgram(this.program)}},{key:"filter",value:function(t,r){this.filterList=t,this.initCanvas("#version 300 es \n\n        in vec2 a_position;\n        in vec2 a_texCoord; \n\n        uniform vec2 u_resolution;\n        uniform float u_flipY;\n\n        out vec2 v_texCoord; \n\n        void main() {\n            vec2 zeroToOne = a_position / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n\n            gl_Position = vec4(clipSpace * vec2(1, u_flipY), 0, 1);\n\n            v_texCoord = a_texCoord;\n        }\n    ",function(t){var r=t.filter((function(t){return"shader"===t.type})).map((function(t){return t.content})).join("\n\n"),e={9:!0};t.filter((function(t){return"convolution"==t.type})).forEach((function(t){e[t.length]=!0}));var n=Object.keys(e).map((function(t){return qt(+t)})).join("\n");return"#version 300 es\n\n    precision highp int;\n    precision mediump float;\n    \n    uniform sampler2D u_image;\n\n    // 3 is 3x3 matrix kernel \n    uniform float u_kernelSelect;\n    uniform float u_filterIndex;\n\n    uniform float u_kernel9[9];\n    uniform float u_kernel9Weight;\n    uniform float u_kernel25[25];\n    uniform float u_kernel25Weight;\n    uniform float u_kernel49[49];\n    uniform float u_kernel49Weight;\n    uniform float u_kernel81[81];\n    uniform float u_kernel81Weight;    \n\n    in vec2 v_texCoord;\n    \n    out vec4 outColor;\n\n    float random (vec2 st) {\n        return fract(sin(dot(st.xy, vec2(12.9898,78.233)))* 43758.5453123);\n    } \n\n    // \n    vec3 rgb2hsv(vec3 c)\n    {\n        vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n        vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\n        vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\n\n        float d = q.x - min(q.w, q.y);\n        float e = 1.0e-10;\n        return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n    }\n\n    vec3 hsv2rgb(vec3 c)\n    {\n        vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n        vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n        return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n    }\n    \n    void main() {\n        vec4 pixelColor = texture(u_image, v_texCoord);\n        vec2 onePixel = vec2(1) / vec2(textureSize(u_image, 0));                \n\n        ".concat(r,"\n\n        ").concat(n,"\n\n    }")}(this.filterList)),this.drawFilter(),"function"==typeof r&&r(this)}}])&&pr(r.prototype,e),t}()};function mr(t){var r=[];"string"==typeof t?r=St(t):Array.isArray(t)&&(r=t);var e=[];return r.forEach((function(t){var r=t.arr[0];if(gr[r]){var n=function(t){var r=t.arr[0],e=gr[r],n=t.arr;return n.shift(),e.apply(this,n)}(t);"convolution"==n.type||"shader"==n.type?e.push(n):n.forEach((function(t){e=e.concat(mr(t))}))}})),e}const yr={filter:function(t,r,e,n){var o=new br.GLCanvas({width:n.width||t.width,height:n.height||t.height,img:t});o.filter(mr(r),(function(){"function"==typeof e&&e(o)}))}};function xr(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function wr(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?xr(Object(e),!0).forEach((function(r){Cr(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):xr(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function Cr(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}const kr=wr(wr({},br),yr);function Ar(t){return function(t){if(Array.isArray(t))return Or(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(t){if("string"==typeof t)return Or(t,r);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Or(t,r):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Or(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,n=new Array(r);e<r;e++)n[e]=t[e];return n}function Tr(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{frameTimer:"full"},o=new at(t);o.loadImage((function(){o.toArray(r,(function(t){"function"==typeof e&&e(t)}),n)}))}const _r={palette:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";return t.length>r&&(t=et(t,r)),t.map((function(t){return e(t,n)}))},ImageToCanvas:function(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{frameTimer:"full"};Tr(t,r,e,Object.assign({returnTo:"canvas"},n))},ImageToHistogram:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{width:200,height:100},n=new at(t);n.loadImage((function(){nt.createHistogram(e.width||200,e.height||100,n.toHistogram(e),(function(t){"function"==typeof r&&r(t.toDataURL("image/png"))}),e)}))},ImageToRGB:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=arguments.length>2?arguments[2]:void 0;if(e){if(e){var n;(n=new at(t,r)).loadImage((function(){"function"==typeof e&&e(n.toRGB())}))}}else(n=new at(t)).loadImage((function(){"function"==typeof r&&r(n.toRGB())}))},ImageToURL:Tr,GLToCanvas:function(t,r,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=new at(t);o.load((function(){kr.filter(o.newImage,r,(function(t){"function"==typeof e&&e(t)}),n)}))},histogram:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=new at(t);n.loadImage((function(){"function"==typeof r&&r(n.toHistogram(e))}))},histogramToPoints:function(t){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,e=[],n=0;n<t.length;n++){var o=t[n];if(0!=n)if(n!=t.length-1){var i=t[n-1],a=t[n+1],c=(a[1],i[1],a[0],i[0],[i[0]+(a[0]-i[0])*r,i[1]+(a[1]-i[1])*r]),l=[Ar(i),[].concat(c)],u=Math.sqrt(Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)),f=Math.sqrt(Math.pow(a[0]-o[0],2)+Math.pow(a[1]-o[1],2)),h=u/f,s=l[0][0]+(l[1][0]-l[0][0])*h,g=l[0][1]+(l[1][1]-l[0][1])*h;l[0][0]+=o[0]-s,l[0][1]+=o[1]-g,l[1][0]+=o[0]-s,l[1][1]+=o[1]-g,e[n]=l}else e[n]=[];else e[n]=[]}return e}};function Er(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function Mr(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?Er(Object(e),!0).forEach((function(r){Sr(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Er(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function Sr(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}const $r=Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr({},a),f),W),O),L),I),{CMYKtoRGB:function(t,r,e,n){if(1==arguments.length){var o=arguments[0];t=o.c,r=o.m,e=o.y,n=o.k}var i=255*(1-t)*(1-n),a=255*(1-r)*(1-n),c=255*(1-e)*(1-n);return{r:i,g:a,b:c}}}),G),p),D),_r);var jr=[{rgb:"#ff0000",start:0},{rgb:"#ffff00",start:.17},{rgb:"#00ff00",start:.33},{rgb:"#00ffff",start:.5},{rgb:"#0000ff",start:.67},{rgb:"#ff00ff",start:.83},{rgb:"#ff0000",start:1}];!function(){for(var t=0,r=jr.length;t<r;t++){var e=jr[t],n=$r.parse(e.rgb);e.r=n.r,e.g=n.g,e.b=n.b}}();const Ir={colors:jr,checkHueColor:function(t){for(var r,e,n=0;n<jr.length;n++)if(jr[n].start>=t){r=jr[n-1],e=jr[n];break}return r&&e?$r.interpolateRGB(r,e,(t-r.start)/(e.start-r.start)):jr[0].rgb}};function Rr(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,n)}return e}function Pr(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}const Br=function(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?Rr(Object(e),!0).forEach((function(r){Pr(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Rr(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}({},{Color:$r,HueColor:Ir,ColorNames:s,GL:kr,Canvas:nt,ImageLoader:at});return r})()}));